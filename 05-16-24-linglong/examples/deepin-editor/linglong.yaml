version: "1"

package:
  id: org.deepin.editor
  name: deepin-editor
  version: 6.0.17.3
  kind: app
  description: |
    editor for deepin os.

base: org.deepin.foundation/20.0.0
runtime: org.deepin.Runtime/20.0.0

command:
  [ /opt/apps/org.deepin.editor/files/bin/deepin-editor ]
 
sources:
  - kind: git
    url: https://github.com/linuxdeepin/deepin-editor.git
    version: 6.0.17

build: |
  SYSTEM_PKG_CONFIG_PATH=/usr/lib/pkgconfig:/usr/lib/${TRIPLET}/pkgconfig:/usr/share/pkgconfig
  RUNTIME_PKG_CONFIG_PATH=/runtime/lib/pkgconfig:/runtime/lib/${TRIPLET}/pkgconfig:/runtime/share/pkgconfig
  APP_PKG_CONFIG_PATH=$PREFIX/lib/pkgconfig:$PREFIX/lib/${TRIPLET}/pkgconfig:$PREFIX/share/pkgconfig
  export PKG_CONFIG_PATH=$SYSTEM_PKG_CONFIG_PATH:$RUNTIME_PKG_CONFIG_PATH:$APP_PKG_CONFIG_PATH
        
  set -e

  cd /project/linglong/sources/deepin-editor.git
 
  mkdir build
  cd build
  cmake -DCMAKE_INSTALL_PREFIX=${PREFIX} -DVERSION=6.0.17.3 ..
  make -j6
  make -j install
